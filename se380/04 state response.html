<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <meta name="generator" content="pandoc">
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <link rel="stylesheet" href="/SE-Notes/style.css" type="text/css">
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
<title>State Response</title>
</head>
<body>

<h1 id="state-response">State Response</h1>
<a href="index.html">Back to se380</a>
<div id="TOC">

<ul>
<li><a href="#e.g.-3.1.1">e.g. 3.1.1</a></li>
<li><a href="#e.g.-3.1.2">e.g. 3.1.2</a></li>
<li><a href="#e.g.-3.1.3">e.g. 3.1.3</a></li>
<li>
<a href="#using-laplace">Using Laplace</a><ul><li><a href="#e.g.">e.g.</a></li></ul>
</li>
<li><a href="#total-response">Total Response</a></li>
<li>
<a href="#stability-of-state-space-models">Stability of state-space models</a><ul><li><a href="#e.g.-3.4.2">e.g. 3.4.2</a></li></ul>
</li>
<li><a href="#bounded-input-bounded-output-stability">Bounded input, bounded output stability</a></li>
</ul>
</div>
<p><span class="math display">\[\begin{align}
\dot{x}&amp;=Ax\\
x &amp;\in \mathbb{R}^n\\
A &amp;\in \mathbb{R}^{n \times n}\\
x(0) &amp;= x_0 \in \mathbb{R}^n \text{ (initial condition) }\\
\end{align}\]</span></p>
<p>Recall:</p>
<ol>
<li>When <span class="math inline">\(n=1\)</span> (A is scalar), the solution is <span class="math inline">\(x(t)=e^{tA}x_0\)</span>
</li>
<li>Taylor series expansion of <span class="math inline">\(e^{At}=1 + At + \frac{(At)^2}{2!} + ...\)</span>
</li>
</ol>
<p>Motivated by 1 and 2, define the <strong>matrix exponential</strong>:<br>
<span class="math display">\[e^A := I + A + \frac{A^2}{2!} + ...\]</span></p>
<h3 id="e.g.-3.1.1">e.g. 3.1.1</h3>
<p><span class="math display">\[\begin{align}
A &amp;= \begin{bmatrix}0 &amp; 0 \\ 0 &amp; 0\end{bmatrix}\\
\Rightarrow e^A &amp;= I + 0 + 0 + ...\\
&amp;= \begin{bmatrix}1 &amp; 0 \\ 0 &amp; 1\end{bmatrix}\\
\end{align}\]</span></p>
<h3 id="e.g.-3.1.2">e.g. 3.1.2</h3>
<p><span class="math display">\[\begin{align}
A &amp;= \begin{bmatrix}1 &amp; 0 \\ 0 &amp; 2\end{bmatrix}\\
\text{For a diagonal matrix:}\\
A^k &amp;= \begin{bmatrix}1^k &amp; 0 \\ 0 &amp; 2^k\end{bmatrix}\\
\Rightarrow e^A &amp;= I + \begin{bmatrix}1 &amp; 0 \\ 0 &amp; 2\end{bmatrix} + \begin{bmatrix}1^2 &amp; 0 \\ 0 &amp; 2^2\end{bmatrix} + ...\\
&amp;= \begin{bmatrix}e^1 &amp; 0 \\ 0 &amp; e^2\end{bmatrix}\\
\end{align}\]</span></p>
<h3 id="e.g.-3.1.3">e.g. 3.1.3</h3>
<p><span class="math display">\[
A = \begin{bmatrix}0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 1 \\ 0 &amp; 0 &amp; 0\end{bmatrix}\\
\]</span><br>
Check that <span class="math inline">\(A^3=0\)</span> (i.e. <span class="math inline">\(A\)</span> is nilpotent).<br>
<span class="math display">\[
e^A = I + A + \frac{A^2}{2} = \begin{bmatrix}1 &amp; 1 &amp; \frac{1}{2} \\ 0 &amp; 1 &amp; 1 \\ 0 &amp; 0 &amp; 1\end{bmatrix}\\
\]</span></p>
<p>Replace <span class="math inline">\(A\)</span> with <span class="math inline">\(tA\)</span> to get a function of time:<br>
<span class="math display">\[e^{At} = I + tA + \frac{t^2A^2}{2!} + ...\]</span></p>
<p><strong>Theorem:</strong> The unique solution to <span class="math inline">\(\dot{x}=Ax, \quad x(0)=x_0\)</span> is <span class="math inline">\(x(t)=e^{tA}x_0\)</span>.</p>
<h2 id="using-laplace">Using Laplace</h2>
<p>Take the Laplace transform of <span class="math inline">\(\dot{x}=Ax\)</span> without assuming <span class="math inline">\(x(0)=0\)</span>:<br>
<span class="math display">\[\begin{align}
sX(s) - x(0) &amp;= AX(s)\\
X(s) &amp;= (sI-A)^{-1} x(0)\\
\end{align}\]</span></p>
<p><strong>Conclusion</strong>: <span class="math inline">\(e^{At}\)</span> and <span class="math inline">\((sI-A)^{-1}\)</span> are Laplace transform pairs.</p>
<h3 id="e.g.">e.g.</h3>
<p><span class="math display">\[\begin{align}
A &amp;= \begin{bmatrix}0&amp;1&amp;0\\0&amp;0&amp;1\\0&amp;0&amp;0\end{bmatrix}\\
sI-A &amp;= \begin{bmatrix}s&amp;-1&amp;0\\0&amp;s&amp;-1\\0&amp;0&amp;s\end{bmatrix}\\
(sI-A)^{-1} &amp;= \frac{\text{adj}(sI-A)}{\det(sI-A)}\\
&amp;= \frac{1}{s^3} \begin{bmatrix}s^2&amp;s&amp;1\\0&amp;s^2&amp;s\\0&amp;0&amp;s^2\end{bmatrix}\\
e^{tA} &amp;= \mathcal{L}^{-1} \left\{ (sI-A)^{-1} \right\}\\
&amp;= \begin{bmatrix}1&amp;t&amp;\frac{t^2}{2}\\0&amp;1&amp;t\\0&amp;0&amp;1\end{bmatrix}, \quad t \ge 0\\
\end{align}\]</span></p>
<h2 id="total-response">Total Response</h2>
<p>The solution of <span class="math inline">\(\dot{x}=Ax+Bu\)</span>, <span class="math inline">\(y=Cx+Du\)</span>, <span class="math inline">\(x(0)=x_0\)</span> is:<br>
<span class="math display">\[x(t) = \underbrace{e^{At}x_0}_\text{initial state response} + \underbrace{\int_0^t e^{A(t-\tau)} Bu(\tau)d\tau}_\text{forced response}\]</span><br>
<span class="math display">\[Y(t)=Cx(t)+Du(t)\]</span></p>
<p>In SISO (single-input-single-output) special case where <span class="math inline">\(x(0)=0\)</span>, we get the familiar result:<br>
<span class="math display">\[\begin{align}
y(t)&amp;=(g * u)(t) = \int_0^t g(t-\tau)u(\tau)d\tau\\
g(t)&amp;=Ce^{At}B 1(t) + D\delta(t)
\end{align}\]</span><br>
Where <span class="math inline">\(1(t)\)</span> is the unit step function and <span class="math inline">\(\delta(t)\)</span> is the unit impulse.</p>
<h2 id="stability-of-state-space-models">Stability of state-space models</h2>
<p>The system <span class="math inline">\(\dot{x}=Ax\)</span> is <strong>asymptotically stable</strong> if <span class="math inline">\(x(t) \rightarrow 0\)</span> for any initial condition.</p>
<p><span class="math inline">\(e^{At} \rightarrow 0\)</span> if and only if all the eigenvalues of <span class="math inline">\(A\)</span> have a negative real part.</p>
<h3 id="e.g.-3.4.2">e.g. 3.4.2</h3>
<p><span class="math display">\[\begin{align}
M\ddot{q}&amp;=u-Kq \quad \text{(mass-spring)}\\
x &amp;= \begin{bmatrix}x_1\\x_2\end{bmatrix} := \begin{bmatrix}q\\\dot{q}\end{bmatrix}\\
\dot{x} &amp;= \begin{bmatrix}0&amp;1\\\frac{-k}{M}&amp;0\end{bmatrix}x + \begin{bmatrix}0\\\frac{1}{M}\end{bmatrix}u\\
\\
\text{Using } M=1, k=4:\\
e^{At} &amp;= \begin{bmatrix}\cos 2t&amp;\frac{1}{2}\sin 2t\\-2\sin 2t &amp; \cos 2t\end{bmatrix}\\
\end{align}\]</span></p>
<p>Since <span class="math inline">\(e^{At}\)</span> does not approach 0 as <span class="math inline">\(t\)</span> grows large, the system is not asymptotically stable.</p>
<p>Let's double-check this using the eigenvalues. Solve for <span class="math inline">\(s\)</span> such that <span class="math inline">\(\det(sI-A)=0\)</span>.<br>
<span class="math display">\[\begin{align}
A &amp;= \begin{bmatrix}0 &amp; 1 \\ -4 &amp; 0 \end{bmatrix}\\
\det \begin{bmatrix}s &amp; -1 \\ 4 &amp; s\end{bmatrix} &amp;= 0\\
s^2 + 4 &amp;= 0\\
s &amp;= \pm 2j
\end{align}\]</span><br>
The system is therefore not asymptotically stable since it has at least one eigenvalue (in this case, it has two) with a non-negative real part.</p>
<p>If we introduce friction:<br>
<span class="math display">\[\begin{align}
\ddot{q} &amp;= u-4q-\dot{q}
\end{align}\]</span></p>
<p>Check that it is asymptotically stable (it should be)</p>
<h2 id="bounded-input-bounded-output-stability">Bounded input, bounded output stability</h2>
<p><span class="math display">\[
Y(s)=G(s)U(s) \quad \text{or} \quad y(t)=(g*u)(t), g(t)=\mathcal{L}^{-1}\left\{G(s)\right\}\\
\]</span></p>
<p>A signal <span class="math inline">\(u(t)\)</span> is <strong>bounded</strong> if there exists a constant <span class="math inline">\(b\)</span> such that, for all <span class="math inline">\(t \ge 0\)</span>, <span class="math inline">\(|u(t)| \le b\)</span>.</p>
<p>For example, <span class="math inline">\(\sin t\)</span> is bounded by <span class="math inline">\(b=1\)</span>.</p>
<p>If <span class="math inline">\(u\)</span> is bounded, <span class="math inline">\(||u||_\infty\)</span> denotes teh <strong>least upper bound</strong>. For example, for <span class="math inline">\(\sin t\)</span>, then <span class="math inline">\(|u(t)| \le 10\)</span> and <span class="math inline">\(u\)</span> is bounded.</p>
<div id="footer">
  Notes by <a href="http://www.davepagurek.com">Dave Pagurek</a>. Contribute <a href="https://github.com/davepagurek/SE-Notes">on GitHub</a>.
</div>
</body>
</html>
